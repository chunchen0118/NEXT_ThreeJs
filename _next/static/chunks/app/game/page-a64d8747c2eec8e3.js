(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[421],{5010:function(e,t,r){Promise.resolve().then(r.bind(r,9776))},9776:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return e8}});var n=r(2265),a=r(125),o=r(3289),i=r(7853),c=r(8978),l=r(643),s=r(708),u=r(1269),m=r(6704),d=r(9856),f=r(8138),h=r(7976),p=r(6190);function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var E=function(e){var t=e.iniPosition;return n.createElement(v,{iniPosition:t})},v=(0,n.forwardRef)(function(e){var t,r=e.iniPosition,a=(0,h.D)(),o=a.camera,i=a.scene,l=(0,h.H)(d.E,"".concat("/NEXT_ThreeJs","/model/character/model/actor.gltf")),s=(0,n.useRef)(null),E=(0,n.useMemo)(function(){return l.scene.traverse(function(e){e instanceof f.Mesh&&(e.castShadow=!0,e.receiveShadow=!0)}),l.scene},[l]),v=(0,n.useContext)(p.l),g=v.mouseViewRef,w=v.controlObjectRef,b=v.playClawMachineStateRef,S=(0,n.useRef)(null),M=(0,n.useRef)(null),x=(0,n.useRef)({x:0,y:0,z:0});(0,u.y1)("w",function(e){M.current&&"character"===w.current&&(x.current.z="keydown"===e.type?-5:0)},{keydown:!0,keyup:!0}),(0,u.y1)("s",function(e){M.current&&"character"===w.current&&(x.current.z="keydown"===e.type?5:0)},{keydown:!0,keyup:!0}),(0,u.y1)("d",function(e){M.current&&"character"===w.current&&(x.current.x="keydown"===e.type?5:0)},{keydown:!0,keyup:!0}),(0,u.y1)("a",function(e){M.current&&"character"===w.current&&(x.current.x="keydown"===e.type?-5:0)},{keydown:!0,keyup:!0});var P=(0,m.v)(l.animations,E).actions;s.current=P.Idle,(0,n.useEffect)(function(){s.current.play()},[]);var I={forward:new f.Quaternion().setFromEuler(new f.Euler(0,Math.PI,0)),backward:new f.Quaternion().setFromEuler(new f.Euler(0,0,0)),left:new f.Quaternion().setFromEuler(new f.Euler(0,-Math.PI/2,0)),right:new f.Quaternion().setFromEuler(new f.Euler(0,Math.PI/2,0)),forwardRight:new f.Quaternion().setFromEuler(new f.Euler(0,3*Math.PI/4,0)),forwardLeft:new f.Quaternion().setFromEuler(new f.Euler(0,-(3*Math.PI)/4,0)),backwardRight:new f.Quaternion().setFromEuler(new f.Euler(0,Math.PI/4,0)),backwardLeft:new f.Quaternion().setFromEuler(new f.Euler(0,-Math.PI/4,0))},C=(0,n.useRef)(new f.Quaternion);(0,h.F)(function(){if(!b.current&&((x.current.x||x.current.z)&&(g.current=!1),M.current)){"character"===w.current?M.current.setLinvel({x:x.current.x,y:M.current.linvel().y-1.5,z:x.current.z},!0):(x.current={x:0,y:0,z:0},M.current.setLinvel({x:0,y:0,z:0},!0));var e=x.current,t=e.x,r=e.z;t>0&&r<0?C.current.copy(I.forwardRight):t<0&&r<0?C.current.copy(I.forwardLeft):t>0&&r>0?C.current.copy(I.backwardRight):t<0&&r>0?C.current.copy(I.backwardLeft):t>0?C.current.copy(I.right):t<0?C.current.copy(I.left):r<0?C.current.copy(I.forward):r>0&&C.current.copy(I.backward);var n=new f.Quaternion().copy(M.current.rotation());n.slerp(C.current,.1),M.current.setRotation(n,!0),0!==M.current.linvel().x||0!==M.current.linvel().z?s.current!==P.Standard_Walk&&(s.current.stop(),s.current=P.Standard_Walk,s.current.play()):s.current!==P.Idle&&(s.current.stop(),s.current=P.Idle,s.current.play())}});var R=new f.Raycaster,j=(0,n.useRef)(0),N=(0,n.useRef)(!1);(0,h.F)(function(){if("character"===w.current&&N.current&&M.current){var e=M.current.translation();R.set(new f.Vector3(e.x+x.current.x/5,1+j.current,e.z+x.current.z/5),new f.Vector3(0,-1,0));var t=R.intersectObjects(i.children,!0);if(!(t.length<=0)){for(var r=0;r<t.length;r++){var n=t[r].object,a=t[r].object.parent.userData.name,o=t[r].point.y;if(t[r].point.y-e.y<1){if(0===x.current.x&&0===x.current.z)return;if(("StairCase111_2"===a||"Object_4"===n.name||"Plane001"===a||"testObj"===a)&&o>j.current){j.current=o,M.current.setTranslation({x:e.x,y:o,z:e.z},!0);return}}}j.current=e.y;return}}});var T=(0,n.useRef)(0),D=(0,n.useRef)(6),k=(0,n.useRef)(0);(0,n.useEffect)(function(){if(M.current&&!b.current&&"character"===w.current){var e=function(e){if(e.deltaY<0)D.current<=6||(D.current-=.5);else if(e.deltaY>0){if(D.current>=10)return;D.current+=.5}};return window.addEventListener("wheel",e),function(){window.removeEventListener("wheel",e)}}},[b,w]);var O=function(e){if(Array.isArray(e))return e}(t=(0,n.useState)(!1))||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,o,i,c=[],l=!0,s=!1;try{for(o=(r=r.call(e)).next;!(l=(n=o.call(r)).done)&&(c.push(n.value),2!==c.length);l=!0);}catch(e){s=!0,a=e}finally{try{if(!l&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw a}}return c}}(t,2)||function(e,t){if(e){if("string"==typeof e)return y(e,2);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return y(e,2)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),G=O[0],z=O[1],A=(0,n.useRef)({x:0,y:0}),B=(0,n.useRef)({x:0,y:0});return(0,n.useEffect)(function(){var e=function(e){M.current&&"character"===w.current&&0===e.button&&(g.current=!0,z(!0),A.current={x:e.clientX,y:e.clientY})},t=function(e){if(M.current&&"character"===w.current&&G){var t=e.clientX-A.current.x,r=-(e.clientY-A.current.y);B.current.x+=.005*t,B.current.y-=.005*r,B.current.y=f.MathUtils.clamp(B.current.y,-Math.PI/2+.1,Math.PI/2-.1),A.current={x:e.clientX,y:e.clientY}}},r=function(){z(!1)};return window.addEventListener("mousedown",e),window.addEventListener("mousemove",t),window.addEventListener("mouseup",r),function(){window.removeEventListener("mousedown",e),window.removeEventListener("mousemove",t),window.removeEventListener("mouseup",r)}},[G,w,g]),(0,h.F)(function(){if(!g.current||!M.current||"character"!==w.current){B.current.x=0,B.current.y=0;return}var e=10*Math.sin(B.current.x),t=10*Math.cos(B.current.x),r=10*Math.sin(B.current.y),n=M.current.translation();o.lookAt(n.x+e,n.y+5+r,n.z+t)}),(0,h.F)(function(){if("character"===w.current&&M.current){var e,t=null===(e=M.current)||void 0===e?void 0:e.translation();T.current=f.MathUtils.lerp(T.current,D.current,.1),k.current=f.MathUtils.lerp(k.current,t.y,.1),o.position.set(t.x,k.current+T.current,t.z+2),g.current||o.lookAt(t.x,k.current+5,t.z)}}),(0,n.useEffect)(function(){S.current&&(S.current.visible=!b.current)},[b.current]),n.createElement("group",{ref:S,dispose:null,position:r,scale:2.5},n.createElement(c.ib,{ref:M,userData:{id:"character"},colliders:"hull",type:"dynamic",mass:70,gravityScale:1,enabledRotations:[!1,!1,!1],onCollisionEnter:function(e){var t;if("stair"===(null===(t=e.other.rigidBody)||void 0===t?void 0:t.userData).id)return N.current=!0;N.current=!1}},n.createElement("primitive",{object:E})))});function g(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,o,i,c=[],l=!0,s=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(c.push(n.value),c.length!==t);l=!0);}catch(e){s=!0,a=e}finally{try{if(!l&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw a}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return w(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return w(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}v.displayName="BasicCharacterModel";var b=(0,n.createContext)(void 0),S=function(e){var t=e.children,r=g((0,n.useState)(""),2),a=r[0],o=r[1],i=(0,n.useRef)("center"),c=g((0,n.useState)("center"),2),l=c[0],s=c[1],u=(0,n.useRef)(!1),m=(0,n.useRef)(!1),d=(0,n.useRef)(!1),f=(0,n.useRef)({target:null,rotation:null,paw:{A:null,B:null,C:null,D:null}}),h=(0,n.useRef)(!1);return n.createElement(b.Provider,{value:{machineID:a,setMachineID:o,retractClawsState:d,itemCatched:f,catchState:u,autoHomingRef:m,clawMachineView:i,clawMachineViewState:l,setClawMachineViewState:s,impactMachineRef:h}},t)},M=r(5918),x=r(2701),P=function(e){var t=e.x1,r=e.y1,n=e.x2;return r+(e.y2-r)/(n-t)*(e.x-t)};function I(e){return(I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function C(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function R(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?C(Object(r),!0).forEach(function(t){var n,a;n=t,a=r[t],(n=function(e){var t=function(e,t){if("object"!==I(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==I(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===I(t)?t:String(t)}(n))in e?Object.defineProperty(e,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[n]=a}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):C(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var j=(0,n.memo)(function(e){var t=e.bodyPosition,r=(0,n.useContext)(b),a=r.retractClawsState,o=r.itemCatched,i=r.machineID,l=r.catchState,s=r.clawMachineView,m=r.setClawMachineViewState,d=(0,n.useContext)(p.l),y=d.controlObjectRef,E=d.playClawMachineStateRef,v=(0,n.useRef)(!1),g=(0,n.useRef)(null),w=(0,n.useRef)({x:t[0]+0,y:0,z:t[2]+0}),S=(0,n.useRef)({x:t[0]-.6,y:0,z:t[2]+0}),M=(0,n.useRef)(!0);(0,u.y1)("up",function(){"clawMachine"===y.current&&(w.current.z<=t[2]-1.4||!M.current||i||(w.current.z-=.05))}),(0,u.y1)("down",function(){"clawMachine"===y.current&&(w.current.z>=t[2]-.1||!M.current||i||(w.current.z+=.05))}),(0,u.y1)("left",function(){"clawMachine"===y.current&&(S.current.x<=t[0]-.6||!M.current||i||(S.current.x-=.05))}),(0,u.y1)("right",function(){"clawMachine"===y.current&&(S.current.x>=t[0]+.6||!M.current||i||(S.current.x+=.05))}),(0,u.y1)("space",function(){if("clawMachine"===y.current){if(!M.current)return v.current=!0;l.current=!0,M.current=!1}}),(0,u.y1)("z",function(){"clawMachine"===y.current&&(s.current="left",m("left"))}),(0,u.y1)("x",function(){"clawMachine"===y.current&&(s.current="center",m("center"))}),(0,u.y1)("c",function(){"clawMachine"===y.current&&(s.current="right",m("right"))});var I=(0,n.useRef)(null),C=(0,n.useRef)(null),j=(0,n.useRef)(null),T=(0,n.useRef)(null),D=(0,n.useRef)({}),k=(0,n.useRef)({x:0,y:0,z:0}),O=(0,n.useCallback)(function(e){U.current=!0;var t=e.target.rigidBody.userData.id,r=e.target.rigidBody,n=e.other.rigidBody;k.current={x:e.other.rigidBodyObject.position.x,y:e.other.rigidBodyObject.position.y,z:e.other.rigidBodyObject.position.z},e.other.rigidBody.setLinearDamping(0),e.other.rigidBody.setAngularDamping(0),e.other.rigidBody.setGravityScale(.5,!0),D.current[n]||(D.current[n]=new Set),D.current[n].add(t),D.current[n].size>=3&&("PawA"===t&&(o.current.paw.A=r),"PawB"===t&&(o.current.paw.B=r),"PawC"===t&&(o.current.paw.C=r),"PawD"===t&&(o.current.paw.D=r),o.current.target=n,o.current.rotation=n.rotation()),"PawA"===t&&(Q.current.pawA=!0),"PawB"===t&&(Q.current.pawB=!0),"PawC"===t&&(Q.current.pawC=!0),"PawD"===t&&(Q.current.pawD=!0)},[o]),G=(0,n.useCallback)(function(e){U.current=!1;var t=e.target.rigidBody.userData.id,r=e.other.rigidBody;D.current[r]&&(D.current[r].delete(t),0===D.current[r].size&&delete D.current[r]),"PawA"===t&&(Q.current.pawA=!1),"PawB"===t&&(Q.current.pawB=!1),"PawC"===t&&(Q.current.pawC=!1),"PawD"===t&&(Q.current.pawD=!1)},[]),z=(0,n.useRef)(null),A=(0,n.useRef)(null),B=(0,n.useRef)(null),F=(0,n.useRef)(null),_=(0,n.useRef)(.1),L=(0,n.useRef)(null),H=(0,n.useRef)("down"),V=(0,n.useRef)(!1),X=(0,n.useRef)(!0),Q=(0,n.useRef)({pawA:!1,pawB:!1,pawC:!1,pawD:!1}),U=(0,n.useRef)(!1),W=-Math.PI/3,Y=0,$=w.current.z,J=(0,n.useRef)(null),K=(0,n.useRef)(!0),Z=(0,n.useRef)(0),q=(0,n.useRef)(0);return(0,h.F)(function(){if("clawMachine"===y.current&&E.current){var e=null===(p=g.current)||void 0===p?void 0:p.translation(),r=w.current.z;r!==$&&(null===(et=g.current)||void 0===et||et.setTranslation({x:null!==(er=null==e?void 0:e.x)&&void 0!==er?er:0,y:null!==(en=null==e?void 0:e.y)&&void 0!==en?en:0,z:r},!0),$=r);var n={x:S.current.x,z:w.current.z+.7},i=null===(b=z.current)||void 0===b?void 0:b.translation();null===(x=z.current)||void 0===x||x.setTranslation(R(R({},n),{},{y:null!==(N=null==i?void 0:i.y)&&void 0!==N?N:0}),!0),null===(D=L.current)||void 0===D||D.setTranslation(R(R({},n),{},{y:4.5-Y}),!0),null===(O=F.current)||void 0===O||O.setTranslation(R(R({},n),{},{y:4.5-_.current}),!0);var c={x:S.current.x,y:4.68-_.current,z:w.current.z+.7};if(null===(G=I.current)||void 0===G||G.setTranslation(c,!0),null===(B=C.current)||void 0===B||B.setTranslation(c,!0),null===(Q=j.current)||void 0===Q||Q.setTranslation(c,!0),null===(ee=T.current)||void 0===ee||ee.setTranslation(c,!0),o.current.target&&a.current){var s=[null===(ea=o.current.paw.A)||void 0===ea?void 0:ea.translation(),null===(eo=o.current.paw.B)||void 0===eo?void 0:eo.translation(),null===(ei=o.current.paw.C)||void 0===ei?void 0:ei.translation(),null===(ec=o.current.paw.D)||void 0===ec?void 0:ec.translation()].filter(function(e){return e}),u=s.reduce(function(e,t){return e+t.x},0),m=s.reduce(function(e,t){return e+t.z},0),d=s.length>0?u/s.length:0,h=s.length>0?m/s.length:0;if(K.current&&(Z.current=t[0]+k.current.x-d,q.current=t[2]+k.current.z-h),Z.current&&q.current&&(o.current.target.setTranslation({x:d+Z.current,y:4.68-_.current-J.current,z:h+q.current},!0),o.current.target.setLinvel({x:0,y:0,z:0},!0),null===(es=o.current)||void 0===es||null===(es=es.target)||void 0===es||es.setBodyType(1,!0)),null!==(el=o.current)&&void 0!==el&&el.rotation){var p,b,x,N,D,O,G,B,Q,ee,et,er,en,ea,eo,ei,ec,el,es,eu,em=o.current.rotation instanceof f.Euler?o.current.rotation:new f.Euler(0,0,0,"XYZ");em.order||(em.order="XYZ");var ed=new f.Quaternion().setFromEuler(em);null===(eu=o.current.target)||void 0===eu||eu.setRotation(ed,!0)}K.current=!1}l.current&&E.current&&Promise.resolve().then(function(){return new Promise(function(e){var t=function(){"down"===H.current&&(_.current>=1.8||U.current||v.current||V.current?(J.current=P({x1:1.8,y1:.35,x2:1.7,y2:.4,x:_.current}),v.current&&e(),H.current="up",setTimeout(function(){e()},1e3)):(_.current+=25e-5,A.current&&L.current&&(Y+=12e-5,A.current.geometry=new f.BoxGeometry(.01,_.current,.01)),setTimeout(function(){return t()},16)))};t()})}).then(function(){return new Promise(function(e){var t=function(){var r,n,o,i,c=new f.Euler(0,0,W),l=new f.Quaternion().setFromEuler(c);null===(r=I.current)||void 0===r||r.setRotation(l,!0);var s=new f.Euler(0,Math.PI/2,W),u=new f.Quaternion().setFromEuler(s);null===(n=C.current)||void 0===n||n.setRotation(u,!0);var m=new f.Euler(0,-Math.PI/2,W),d=new f.Quaternion().setFromEuler(m);null===(o=j.current)||void 0===o||o.setRotation(d,!0);var h=new f.Euler(0,-Math.PI/1,W),p=new f.Quaternion().setFromEuler(h);null===(i=T.current)||void 0===i||i.setRotation(p,!0),W<=-Math.PI/4.2?(W<=-Math.PI/6&&(a.current=!0),W+=Math.PI/360,_.current-=.002,A.current&&L.current&&(A.current.geometry=new f.BoxGeometry(.01,_.current,.01),Y>=0&&(Y-=.001)),setTimeout(function(){return t()},16)):setTimeout(function(){e()},1e3)};t()})}).then(function(){return new Promise(function(e){var t=function(){"up"===H.current&&(_.current<=.1?e():(_.current-=.02,A.current&&L.current&&(A.current.geometry=new f.BoxGeometry(.01,_.current,.01),Y>=0&&(Y-=.01)),setTimeout(function(){return t()},16)))};t()})}).then(function(){return new Promise(function(e){var r=function(){X.current&&(S.current.x>=t[0]-.6&&(S.current.x-=.01),w.current.z<=t[2]+0&&(w.current.z+=.01),S.current.x<t[0]-.6&&w.current.z>t[2]+0?setTimeout(function(){e()},1e3):setTimeout(function(){return r()},16))};r()})}).then(function(){return new Promise(function(e){var t=function(){var r,n,i,c,l,s=new f.Euler(0,0,W),u=new f.Quaternion().setFromEuler(s);null===(r=I.current)||void 0===r||r.setRotation(u,!0);var m=new f.Euler(0,Math.PI/2,W),d=new f.Quaternion().setFromEuler(m);null===(n=C.current)||void 0===n||n.setRotation(d,!0);var h=new f.Euler(0,-Math.PI/2,W),p=new f.Quaternion().setFromEuler(h);null===(i=j.current)||void 0===i||i.setRotation(p,!0);var y=new f.Euler(0,-Math.PI/1,W),E=new f.Quaternion().setFromEuler(y);null===(c=T.current)||void 0===c||c.setRotation(E,!0),W>=-Math.PI/3?(W>=-Math.PI/2.5&&(null===(l=o.current)||void 0===l||null===(l=l.target)||void 0===l||l.setBodyType(0,!0),a.current=!1),W-=Math.PI/360,setTimeout(function(){return t()},16)):(o.current.target=null,e())};t()})}).then(function(){return new Promise(function(e){setTimeout(function(){l.current=!1,H.current="down",v.current=!1,X.current=!0,M.current=!0,K.current=!0,e()},1e3)})})}}),n.createElement(n.Fragment,null,n.createElement("group",{position:[0,4.7,0]},n.createElement(c.ib,{type:"fixed","position-y":0,ref:g},n.createElement("mesh",{position:[0,0,.8],rotation:[0,0,Math.PI/2],castShadow:!0,receiveShadow:!0},n.createElement("cylinderGeometry",{args:[.03,.03,1.7]}),n.createElement("meshStandardMaterial",{color:"rgb(188, 188, 188)",metalness:.9,roughness:.4})),n.createElement("mesh",{position:[0,0,.6],rotation:[0,0,Math.PI/2],castShadow:!0,receiveShadow:!0},n.createElement("cylinderGeometry",{args:[.03,.03,1.7]}),n.createElement("meshStandardMaterial",{color:"rgb(188, 188, 188)",metalness:.9,roughness:.4}))),n.createElement(c.ib,{ref:z,type:"fixed",position:[-.5,0,.7]},n.createElement(x.Z,{args:[.3,.5,.4],radius:.05,smoothness:4,rotation:[0,0,Math.PI/2],castShadow:!0,receiveShadow:!0,position:[0,0,0]},n.createElement("meshStandardMaterial",{color:"rgb(17, 69, 93)",metalness:.5,roughness:.5}))),n.createElement(c.ib,{ref:L,position:[-.5,-.2,.7],gravityScale:0,type:"fixed"},n.createElement("mesh",{ref:A,castShadow:!0,receiveShadow:!0},n.createElement("boxGeometry",{args:[.01,.1,.01]}),n.createElement("meshStandardMaterial",{color:"#0bd5f4"}))),n.createElement(c.ib,{ref:F,type:"fixed",colliders:"trimesh",position:[-.5,-.3,.7],restitution:.1,friction:1,linearDamping:5,angularDamping:5,gravityScale:0,canSleep:!1,onCollisionEnter:function(){V.current=!0},onCollisionExit:function(){V.current=!1}},n.createElement("mesh",{ref:B,rotation:[0,0,0],castShadow:!0,receiveShadow:!0},n.createElement("cylinderGeometry",{args:[.1,.075,.1]}),n.createElement("meshStandardMaterial",{color:"rgb(17, 69, 93)",metalness:.7,roughness:.1}))),n.createElement(N,{ref:I,userId:"PawA",position:[-.5,-.1,.7],rotation:[0,0,-Math.PI/3],onCollisionEnter:O,onIntersectionExit:G}),n.createElement(N,{ref:C,userId:"PawB",position:[-.5,-.1,.7],rotation:[0,Math.PI/2,-Math.PI/3],onCollisionEnter:O,onIntersectionExit:G}),n.createElement(N,{ref:j,userId:"PawC",position:[-.5,-.1,.7],rotation:[0,-Math.PI/2,-Math.PI/3],onCollisionEnter:O,onIntersectionExit:G}),n.createElement(N,{ref:T,userId:"PawD",position:[-.5,-.1,.7],rotation:[0,Math.PI/1,-Math.PI/3],onCollisionEnter:O,onIntersectionExit:G})))});j.displayName="CraneCarriage";var N=(0,n.memo)((0,n.forwardRef)(function(e,t){var r=e.position,a=e.rotation,o=e.onCollisionEnter,i=e.onIntersectionExit,l=e.userId,s=new Float32Array([0,2,0,-.7,0,0,1,-1,0,-1,0,.3,-1,0,-.3,-1.1,0,0]),u=new Uint16Array([0,3,1,0,1,4,1,3,2,1,2,4,0,5,3,0,4,5,1,5,3,1,5,4,3,5,2,4,2,5]),m=new f.BufferGeometry;return m.setAttribute("position",new f.BufferAttribute(s,3)),m.setIndex(new f.BufferAttribute(u,1)),n.createElement(c.ib,{ref:t,userData:{id:l},type:"fixed",position:r,rotation:a,colliders:"trimesh",restitution:0,onCollisionEnter:o,onIntersectionExit:i,ccd:!0},n.createElement("group",{position:[.2,-.35,0]},n.createElement("mesh",{geometry:m,scale:[.13,.13,.13],castShadow:!0,receiveShadow:!0},n.createElement("meshStandardMaterial",{color:"rgb(17, 69, 93)",metalness:.5,roughness:.1}))))})),T=r(3120),D=r(5682),k=function(e){var t=e.bodyPosition,r=e.catchItem,a=(0,n.memo)(function(e){var t=e.catchItem;return n.createElement(n.Fragment,null,t&&n.createElement(T.o,{font:"./fonts/2.json",position:[-.65,3.7,-.8],scale:.3,castShadow:!0,receiveShadow:!0},"Got it!",n.createElement("meshNormalMaterial",null)))});return a.displayName="TextGotIt",n.createElement(n.Fragment,null,n.createElement(c.ib,{type:"fixed",friction:1,restitution:0,colliders:"trimesh",ccd:!0},n.createElement("mesh",{position:[0,5.1,0],castShadow:!0,receiveShadow:!0},n.createElement("boxGeometry",{args:[2.05,.4,2.05]}),n.createElement("meshStandardMaterial",{color:"rgb(0, 0, 0)",metalness:.5,roughness:.5}))),n.createElement(D.P,{color:"white",intensity:7,distance:10,angle:Math.PI/2.5,penumbra:.5,decay:2,position:[0,5.3,0],"target-position":t,"shadow-mapSize-width":1024,"shadow-mapSize-height":1024,"shadow-camera-near":.5,"shadow-camera-far":10,opacity:0,castShadow:!0}),n.createElement(j,{bodyPosition:t}),n.createElement(c.ib,{type:"fixed",friction:1,restitution:0,colliders:"trimesh",ccd:!0},n.createElement("mesh",{position:[0,3.72,-1],castShadow:!0,receiveShadow:!0},n.createElement("boxGeometry",{args:[2.02,2.5,.01]}),n.createElement("meshStandardMaterial",{color:"black",roughness:.5,metalness:.5}))),n.createElement(c.ib,{type:"fixed",friction:1,restitution:0,colliders:"trimesh",ccd:!0},n.createElement("mesh",{position:[0,3.72,-.99],castShadow:!0,receiveShadow:!0},n.createElement("boxGeometry",{args:[2.02,2.5,.01]}),n.createElement("meshStandardMaterial",{color:"white",roughness:.1,metalness:0}))),n.createElement(G,null),n.createElement(a,{catchItem:r}),n.createElement(c.ib,{type:"fixed",friction:1,restitution:0,colliders:"trimesh",ccd:!0},n.createElement("mesh",{position:[0,3.72,1]},n.createElement("boxGeometry",{args:[2,2.5,.01]}),n.createElement("meshPhysicalMaterial",{color:"white",transparent:!0,opacity:.03}))),n.createElement(O,{color:"silver",position:[0,3.7,0],rotation:[0,0,0]}),n.createElement(c.ib,{type:"fixed",friction:1,restitution:0,colliders:"trimesh",ccd:!0},n.createElement("mesh",{position:[-1,3.72,0]},n.createElement("boxGeometry",{args:[.01,2.5,2]}),n.createElement("meshPhysicalMaterial",{color:"white",transparent:!0,opacity:.03}))),n.createElement(O,{color:"silver",position:[0,3.7,0],rotation:[0,-Math.PI/2,0]}),n.createElement(c.ib,{type:"fixed",friction:1,restitution:0,colliders:"trimesh",ccd:!0},n.createElement("mesh",{position:[1,3.72,0]},n.createElement("boxGeometry",{args:[.01,2.5,2]}),n.createElement("meshPhysicalMaterial",{color:"white",transparent:!0,opacity:.03,reflectivity:.98}))),n.createElement(O,{color:"silver",position:[0,3.7,0],rotation:[0,Math.PI/2,0]}))};k.displayName="MachineUpperPart";var O=(0,n.memo)(function(e){var t=e.position,r=e.rotation,a=e.color,o=new Float32Array([-1,-1.25,1,1,-1.25,1,1,-1.25,1,1,1.25,1,1,1.25,1,-1,1.25,1,-1,1.25,1,-1,-1.25,1]),i=new f.BufferGeometry;return i.setAttribute("position",new f.BufferAttribute(o,3)),n.createElement("lineSegments",{geometry:i,position:t,rotation:r},n.createElement("lineBasicMaterial",{color:a}))});O.displayName="DoorFrame";var G=function(){var e=(0,h.D)().camera,t=(0,n.useMemo)(function(){var e,t,r=document.createElement("canvas"),n=r.getContext("2d");r.width=200,r.height=256;var a=new f.CanvasTexture(r);return n&&(e="blue",(t=n.createLinearGradient(0,0,256,256)).addColorStop(0,"red"),t.addColorStop(1,e),n.fillStyle=t,n.fillRect(0,0,256,256),a.needsUpdate=!0),a},[]),r=(0,n.useMemo)(function(){return{r:100,g:20,b:40}},[]),a=(0,n.useMemo)(function(){return{r:15,g:20,b:100}},[]);return(0,h.F)(function(){var n=e.position.x;r.r=(Math.sin(.5*n)+1)/2,r.g=(Math.cos(.5*n)+1)/2,a.b=(Math.sin(.5*n+Math.PI)+1)/2;var o="rgb(".concat(255*r.r,", ").concat(255*r.g,", ").concat(255*r.b,")"),i="rgb(".concat(255*a.r,", ").concat(255*a.g,", ").concat(255*a.b,")"),c=t.image.getContext("2d");if(c){var l=c.createLinearGradient(0,0,256,256);l.addColorStop(0,o),l.addColorStop(1,i),c.fillStyle=l,c.fillRect(0,0,256,256),t.needsUpdate=!0}}),n.createElement(c.ib,{type:"fixed",friction:1,restitution:0,colliders:"trimesh",ccd:!0},n.createElement("mesh",{position:[0,3.72,-.98],castShadow:!0,receiveShadow:!0},n.createElement("boxGeometry",{args:[2.02,2.5,.01]}),n.createElement("meshPhysicalMaterial",{map:t,roughness:.9,metalness:.8,reflectivity:.5})))},z=(0,n.memo)(function(e){var t=e.count,r=(0,n.useContext)(b),a=r.retractClawsState,o=r.itemCatched,i=r.impactMachineRef,l=(0,n.useContext)(p.l),s=l.playClawMachineStateRef,u=l.controlObjectRef,m=(0,n.useRef)(null),d=(0,n.useRef)([]),f=(0,n.useMemo)(function(){return Array.from({length:t},function(e,t){return{key:t,position:[(Math.random()-.5)*.5,(Math.random()+3)*1,(Math.random()-.5)*.5],id:"cube_".concat(t)}})},[t]),y=(0,h.D)().camera;return(0,h.F)(function(){"clawMachine"===u.current&&s.current&&(d.current.forEach(function(e){if(e){var t=e.linvel();e.setLinvel({x:Math.min(Math.max(t.x,-3),3),y:Math.min(Math.max(t.y,-3),3),z:Math.min(Math.max(t.z,-3),3)},!0);var r=e.angvel();e.setAngvel({x:Math.min(Math.max(r.x,-3),3),y:Math.min(Math.max(r.y,-3),3),z:Math.min(Math.max(r.z,-3),3)},!0)}}),a.current&&d.current.forEach(function(e){if(e&&!o.current.target&&0!==e.bodyType())return e.setBodyType(0,!0)}))}),(0,h.F)(function(e){var t=e.clock;if("clawMachine"===u.current&&s.current){var r=t.getElapsedTime();i.current&&(d.current.forEach(function(e){null==e||e.applyImpulse({x:.05*Math.sin(2*Math.random()*Math.PI),y:0,z:.05*Math.sin(2*Math.random()*Math.PI)},!0)}),i.current=!1,y.position.x+=.1*Math.sin(1.5*r),y.position.z-=.1*Math.cos(1.5*r))}}),n.createElement(n.Fragment,null,n.createElement("group",{ref:m},f.map(function(e,t){return n.createElement(n.Fragment,{key:e.id},n.createElement(c.ib,{ref:function(e){d.current[t]=e},colliders:"hull",key:"rhomboid_".concat(t),userData:{id:e.id},position:e.position,restitution:.1,friction:1,gravityScale:.8,linearDamping:10,angularDamping:10,mass:10},n.createElement("mesh",{castShadow:!0,receiveShadow:!0},n.createElement("sphereGeometry",{args:[.2,.6,.2]}),n.createElement("meshStandardMaterial",{color:"#2eedaa",roughness:.3,metalness:.5}))))})))});function A(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,o,i,c=[],l=!0,s=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(c.push(n.value),c.length!==t);l=!0);}catch(e){s=!0,a=e}finally{try{if(!l&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw a}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return B(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return B(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function B(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}z.displayName="CatchProducts";var F=(0,n.forwardRef)(function(e,t){var r=e.bodyPosition,a=(0,n.useContext)(b),o=a.clawMachineView,i=a.catchState,l=a.autoHomingRef,s=a.impactMachineRef,m=a.clawMachineViewState,d=(0,n.useContext)(p.l),f=d.controlObjectRef,y=d.playClawMachineState,E=d.setPlayClawMachineState,v=d.playClawMachineStateRef,g=A((0,n.useState)(!1),2),w=g[0],S=g[1],x=(0,n.useRef)(!0),P=A((0,n.useState)(!1),2),I=P[0],C=P[1];(0,u.y1)("v",function(){"clawMachine"===f.current&&x.current&&(s.current=!0,x.current=!1,setTimeout(function(){x.current=!0},2e3))}),(0,u.y1)("f",function(){I&&!i.current&&("clawMachine"!==f.current?(f.current="clawMachine",E(!0),v.current=!0):(f.current="character",o.current="center",i.current=!1,l.current=!0,E(!1),v.current=!1))},{keydown:!1,keyup:!0});var R=(0,h.D)().camera,j=function(e,t,r){return e+(t-e)*r};return(0,h.F)(function(e){var t=e.clock;if("clawMachine"===f.current&&v.current){var n=Math.min(t.getElapsedTime()/2,1),a=[0,4.8,-8.5],i=[r[0],r[1]+3,r[2]];"right"===o.current?a=[1.5,5,-10.85]:"left"===o.current&&(a=[-1.5,5,-10.85]),R.position.x=j(R.position.x,a[0],.05*n),R.position.y=j(R.position.y,a[1],.05*n),R.position.z=j(R.position.z,a[2],.05*n),R.lookAt(j(R.position.x,i[0],.05*n),j(R.position.y,i[1],.05*n),j(R.position.z,i[2],.05*n)),1===n&&t.start()}}),n.createElement("group",{position:r,ref:t},n.createElement(L,{bodyPosition:r,setSensor:C}),y&&"center"===m&&n.createElement(M.V,{position:[2,3.5,.1]},n.createElement("div",{className:"text-white text-2xl flex items-center space-x-1 p-2 "},n.createElement("span",{className:"w-100 text-nowrap text-zinc-500 mr-2"},"方向操控"),n.createElement("span",{className:"w-12 h-12 rounded-md bg-stone-600/50 flex items-center justify-center backdrop-blur-sm"},"↑"),n.createElement("span",{className:"w-12 h-12 rounded-md bg-stone-600/50 flex items-center justify-center backdrop-blur-sm"},"↓"),n.createElement("span",{className:"w-12 h-12 rounded-md bg-stone-600/50 flex items-center justify-center backdrop-blur-sm"},"→"),n.createElement("span",{className:"w-12 h-12 rounded-md bg-stone-600/50 flex items-center justify-center backdrop-blur-sm"},"←")),n.createElement("div",{className:"text-white text-2xl flex items-center space-x-1 p-2 "},n.createElement("span",{className:"w-100 text-nowrap text-zinc-500 mr-2"},"抓取 / 提前收爪"),n.createElement("span",{className:"w-100 h-12 px-2 rounded-md bg-stone-600/50 flex items-center justify-center backdrop-blur-sm"},"space")),n.createElement("div",{className:"text-white text-2xl flex items-center space-x-1 p-2 "},n.createElement("span",{className:"w-100 text-nowrap text-zinc-500 mr-2"},"搖晃機台"),n.createElement("span",{className:"w-100 h-12 px-2 rounded-md bg-stone-600/50 flex items-center justify-center backdrop-blur-sm"},"V")),n.createElement("div",{className:"text-white text-2xl flex items-center space-x-1 p-2 "},n.createElement("span",{className:"w-100 text-nowrap text-zinc-500 mr-2"},"視角切換"),n.createElement("span",{className:"w-12 h-12 rounded-md bg-stone-600/50 flex items-center justify-center backdrop-blur-sm"},"Z"),n.createElement("span",{className:"w-12 h-12 rounded-md bg-stone-600/50 flex items-center justify-center backdrop-blur-sm"},"X"),n.createElement("span",{className:"w-12 h-12 rounded-md bg-stone-600/50 flex items-center justify-center backdrop-blur-sm"},"C")),n.createElement("div",{className:"text-white text-2xl flex items-center space-x-1 p-2 "},n.createElement("span",{className:"w-100 text-nowrap text-zinc-500 mr-2"},"結束遊玩"),n.createElement("span",{className:"w-12 h-12 rounded-md bg-stone-600/50 flex items-center justify-center backdrop-blur-sm"},"F"))),I&&!y&&n.createElement(M.V,{position:[2,3.5,.1]},n.createElement("div",{className:"text-white text-2xl flex items-center space-x-1 p-2 "},n.createElement("span",{className:"w-100 text-nowrap text-zinc-500 mr-2"},"遊玩"),n.createElement("span",{className:"w-12 h-12 rounded-md bg-stone-600/50 flex items-center justify-center backdrop-blur-sm"},"F"))),n.createElement(k,{bodyPosition:r,catchItem:w}),n.createElement(z,{count:25}),n.createElement(_,{color:"rgb(190, 0, 0)",position:[0,2.4,0],rotation:[-Math.PI/2,0,0]}),n.createElement(_,{color:"rgb(190, 0, 0)",position:[0,2.39,0],rotation:[-Math.PI/2,0,0]}),n.createElement(c.ib,{type:"fixed",restitution:.1,friction:1,colliders:"trimesh",ccd:!0},n.createElement("mesh",{position:[-.645,2.55,.3],castShadow:!0,receiveShadow:!0},n.createElement("boxGeometry",{args:[.7,.3,.01]}),n.createElement("meshStandardMaterial",{color:"white",transparent:!0,opacity:.8}))),n.createElement(c.ib,{type:"fixed",restitution:.1,friction:1,colliders:"trimesh",ccd:!0},n.createElement("mesh",{position:[-.3,2.55,.65],rotation:[0,Math.PI/2,0],castShadow:!0,receiveShadow:!0},n.createElement("boxGeometry",{args:[.7,.3,.01]}),n.createElement("meshStandardMaterial",{color:"white",transparent:!0,opacity:.8}))),n.createElement(V,null),n.createElement(c.ib,{type:"fixed",restitution:.1,friction:1,colliders:"trimesh"},n.createElement("mesh",{position:[0,1.22,-1],castShadow:!0,receiveShadow:!0},n.createElement("boxGeometry",{args:[2,2.5,.01]}),n.createElement("meshStandardMaterial",{color:"rgb(0, 0, 0)",metalness:.5,roughness:.5}))),n.createElement(Y,{color:"rgb(0, 0, 0)",position:[0,1.47,1.002],rotation:[0,0,0]}),n.createElement(X,null),n.createElement(c.ib,{type:"fixed",restitution:.5,friction:1,colliders:"trimesh"},n.createElement("mesh",{position:[-1,1.22,0],castShadow:!0,receiveShadow:!0},n.createElement("boxGeometry",{args:[.01,2.5,2]}),n.createElement("meshStandardMaterial",{color:"rgb(0, 0, 0)",metalness:.5,roughness:.5}))),n.createElement(c.ib,{type:"fixed",restitution:.5,friction:1,colliders:"trimesh",ccd:!0},n.createElement("mesh",{position:[1,1.22,0],castShadow:!0,receiveShadow:!0},n.createElement("boxGeometry",{args:[.01,2.5,2]}),n.createElement("meshStandardMaterial",{color:"rgb(0, 0, 0)",metalness:.5,roughness:.5}))),n.createElement(c.ib,{type:"fixed",restitution:.5,friction:.05,colliders:"trimesh",ccd:!0},n.createElement("mesh",{position:[-.65,1.95,.544],rotation:[-Math.PI/6,0,0],castShadow:!0,receiveShadow:!0},n.createElement("boxGeometry",{args:[.7,.02,1]}),n.createElement("meshStandardMaterial",{color:"white"}))),n.createElement(H,{setCatchItem:S}),n.createElement(c.ib,{type:"fixed",restitution:.5,friction:.05,colliders:"trimesh",ccd:!0},n.createElement("mesh",{position:[-.65,.95,-.55],rotation:[Math.PI/6,0,0],castShadow:!0,receiveShadow:!0},n.createElement("boxGeometry",{args:[.7,.02,1]}),n.createElement("meshStandardMaterial",{color:"white"}))),n.createElement(c.ib,{type:"fixed",restitution:.5,friction:.05,colliders:"trimesh",ccd:!0},n.createElement("mesh",{position:[-.65,.2,0],rotation:[Math.PI/18,0,0],castShadow:!0,receiveShadow:!0},n.createElement("boxGeometry",{args:[.7,.02,2]}),n.createElement("meshStandardMaterial",{color:"white"}))),n.createElement(c.ib,{type:"fixed",restitution:.5,friction:.05,colliders:"trimesh",ccd:!0},n.createElement("mesh",{position:[-.29,1.21,0],rotation:[0,0,0],castShadow:!0,receiveShadow:!0},n.createElement("boxGeometry",{args:[.01,2.35,2]}),n.createElement("meshStandardMaterial",{color:"white"}))),n.createElement(c.ib,{type:"fixed",restitution:.5,friction:1,colliders:"trimesh",ccd:!0},n.createElement("mesh",{position:[0,.01,0],castShadow:!0,receiveShadow:!0},n.createElement("boxGeometry",{args:[1.99,.01,1.99]}),n.createElement("meshStandardMaterial",{color:"rgb(190, 0, 0)"}))))});F.displayName="ClawMachine";var _=(0,n.memo)(function(e){var t=e.position,r=e.rotation,a=e.color,o=new f.Shape;return o.moveTo(-1,1),o.lineTo(1,1),o.lineTo(1,-1),o.lineTo(-.3,-1),o.lineTo(-.3,-.3),o.lineTo(-1,-.3),o.lineTo(-1,1),n.createElement("group",{position:t,rotation:r},n.createElement(c.ib,{type:"fixed",restitution:.1,friction:1,gravityScale:.5,colliders:"trimesh",ccd:!0},n.createElement(i.WL,{args:[o,{depth:.02,bevelEnabled:!1}],castShadow:!0,receiveShadow:!0},n.createElement("meshPhysicalMaterial",{color:a,metalness:.8,roughness:.5,reflectivity:.1}))))});_.displayName="PlatformWithHole";var L=(0,n.memo)(function(e){var t=e.bodyPosition,r=e.setSensor;return n.createElement(c.ib,{type:"fixed",position:[t[0],t[1]+.1,t[2]+11],sensor:!0,onIntersectionEnter:function(){r(!0)},onIntersectionExit:function(){r(!1)}},n.createElement(c.jc,{args:[4,.01,2]}))});L.displayName="SensorMachineChoose";var H=(0,n.memo)(function(e){var t=e.setCatchItem,r=function(){t(!0),setTimeout(function(){t(!1)},5e3)};return n.createElement(c.ib,{type:"fixed",colliders:!1,position:[-.65,2,.1],rotation:[-Math.PI/2,0,0]},n.createElement(c.jc,{args:[.3,.02,.35],sensor:!0,onIntersectionEnter:function(){return r()}}))});H.displayName="SensorBaffle";var V=function(){var e=(0,n.useRef)(null),t=(0,n.useRef)(null),r=(0,c.dv)().world;return(0,n.useEffect)(function(){var n=setTimeout(function(){e.current&&t.current&&(r.removeRigidBody(e.current),r.removeRigidBody(t.current))},3e3);return function(){return clearTimeout(n)}},[r]),n.createElement(n.Fragment,null,n.createElement(c.ib,{position:[-.65,3.1,.6],rotation:[0,0,-Math.PI/4],ref:e,type:"fixed",restitution:1,ccd:!0},n.createElement(c.jc,{args:[.45,.01,.4]})),n.createElement(c.ib,{position:[-.7,3,.3],rotation:[0,0,0],ref:t,type:"fixed",restitution:1,ccd:!0},n.createElement(c.jc,{args:[.3,.2,.01]}),n.createElement("meshStandardMaterial",{color:"white",transparent:!0,opacity:.8})))};V.displayName="SpecialBaffle";var X=(0,n.memo)(function(){return n.createElement(n.Fragment,null,n.createElement("mesh",{position:[0,1.9,1.2],castShadow:!0,receiveShadow:!0},n.createElement("boxGeometry",{args:[1,.8,.4]}),n.createElement("meshStandardMaterial",{color:"rgb(0, 0, 0)",metalness:.5,roughness:.5}),n.createElement(Q,{color:"silver",position:[-.3,.35,0],rotation:[0,Math.PI/2,0]}),n.createElement(W,{color:"gray",position:[.3,.4001,0],rotation:[-Math.PI/2,0,0]}),n.createElement(U,null),n.createElement("mesh",{position:[.2,0,.01],castShadow:!0,receiveShadow:!0},n.createElement("boxGeometry",{args:[.2,.4,.4]}),n.createElement("meshStandardMaterial",{color:"rgb(171, 0, 0)",metalness:.5,roughness:.2}),n.createElement("mesh",{position:[0,.1,.16],castShadow:!0,receiveShadow:!0},n.createElement("boxGeometry",{args:[.01,.1,.1]}),n.createElement("meshStandardMaterial",{color:"black"})),n.createElement("mesh",{position:[0,0,.16],rotation:[0,0,Math.PI/6],castShadow:!0,receiveShadow:!0},n.createElement("boxGeometry",{args:[.01,.06,.1]}),n.createElement("meshStandardMaterial",{color:"white"})),n.createElement("mesh",{position:[0,-.1,.16],castShadow:!0,receiveShadow:!0},n.createElement("boxGeometry",{args:[.01,.1,.1]}),n.createElement("meshStandardMaterial",{color:"black"}))),n.createElement("mesh",{position:[-.2,0,.01],castShadow:!0,receiveShadow:!0},n.createElement("boxGeometry",{args:[.2,.4,.4]}),n.createElement("meshStandardMaterial",{color:"rgb(171, 0, 0)",metalness:.5,roughness:.2}),n.createElement("mesh",{position:[0,.1,.16],castShadow:!0,receiveShadow:!0},n.createElement("boxGeometry",{args:[.01,.1,.1]}),n.createElement("meshStandardMaterial",{color:"black"})),n.createElement("mesh",{position:[0,0,.16],rotation:[0,0,Math.PI/6],castShadow:!0,receiveShadow:!0},n.createElement("boxGeometry",{args:[.01,.06,.1]}),n.createElement("meshStandardMaterial",{color:"white"})),n.createElement("mesh",{position:[0,-.1,.16],castShadow:!0,receiveShadow:!0},n.createElement("boxGeometry",{args:[.01,.1,.1]}),n.createElement("meshStandardMaterial",{color:"black"})))))});X.displayName="ControlBox";var Q=(0,n.memo)(function(e){var t=e.position,r=e.rotation,a=e.color,o=new f.SphereGeometry(.1,32,32,0,2*Math.PI,0,Math.PI/3);return n.createElement("mesh",{position:t,rotation:r,castShadow:!0,receiveShadow:!0},n.createElement("primitive",{object:o,attach:"geometry"}),n.createElement("meshStandardMaterial",{color:a,metalness:.5,roughness:.5}))});Q.displayName="ControlButton";var U=(0,n.memo)(function(){return n.createElement("mesh",{position:[0,.45,0],rotation:[0,0,0],castShadow:!0,receiveShadow:!0},n.createElement("cylinderGeometry",{args:[.02,.02,.15,32]}),n.createElement("meshStandardMaterial",{color:"white",metalness:.5,roughness:.5}),n.createElement("mesh",{position:[0,.12,0],castShadow:!0,receiveShadow:!0},n.createElement("sphereGeometry",{args:[.08,32,16,0,2*Math.PI,0,Math.PI]}),n.createElement("meshStandardMaterial",{color:"rgb(131, 0, 0)",metalness:.5,roughness:.5})),n.createElement("mesh",{position:[0,-.05,0],rotation:[Math.PI/2,0,0],castShadow:!0,receiveShadow:!0},n.createElement("torusGeometry",{args:[.05,.01,4,32]}),n.createElement("meshStandardMaterial",{color:"rgb(131, 0, 0)"})))});U.displayName="ControlJoystick";var W=(0,n.memo)(function(e){var t=e.position,r=e.rotation,a=e.color;return n.createElement("group",null,n.createElement("mesh",{position:t,rotation:r},n.createElement("planeGeometry",{args:[.3,.2]}),n.createElement("meshStandardMaterial",{color:a})),n.createElement(J,{color:"purple",position:[.3,.401,0],rotation:[-Math.PI/2,0,0]}))});W.displayName="DisplayScreen";var Y=(0,n.memo)(function(e){var t=e.position,r=e.rotation,a=e.color,o=new f.Shape;o.moveTo(-1,-1.5),o.lineTo(1,-1.5),o.lineTo(1,1),o.lineTo(-1,1),o.lineTo(-1,-1);var i=new f.Path;i.moveTo(-1,-1.3),i.lineTo(-.3,-1.3),i.lineTo(-.3,-.3),i.lineTo(-1,-.3),i.lineTo(-1,-1),o.holes.push(i);var l=new f.ShapeGeometry(o);return n.createElement(c.ib,{type:"fixed",restitution:.1,friction:1,colliders:"trimesh"},n.createElement("mesh",{position:t,rotation:r},n.createElement("primitive",{object:l,attach:"geometry"}),n.createElement("meshStandardMaterial",{color:a,metalness:.5,roughness:.5}),n.createElement($,{color:"rgb(131, 0, 0)",position:[-.65,-.8,0],rotation:[Math.PI/2,0,0]})))});Y.displayName="OpeningDoorWithHole";var $=(0,n.memo)(function(e){var t=e.position,r=e.rotation,a=e.color;return n.createElement("mesh",{position:t,rotation:r,castShadow:!0,receiveShadow:!0},n.createElement("boxGeometry",{args:[.7,.02,1]}),n.createElement("meshPhysicalMaterial",{color:a,transparent:!0,opacity:.7,roughness:.3,clearcoat:.8,clearcoatRoughness:.1}))});$.displayName="ExitDoorPanel";var J=(0,n.memo)(function(e){var t=e.position,r=e.rotation,a=e.color,o=(0,n.useRef)(null);return(0,n.useEffect)(function(){var e=document.createElement("canvas"),t=e.getContext("2d");t.font="108px Arial",t.fillStyle="white",t.fillText("00",80,120);var r=new f.CanvasTexture(e),n=new f.MeshBasicMaterial({map:r,transparent:!0});o.current&&(o.current.material=n)},[]),n.createElement("mesh",{ref:o,position:t,rotation:r},n.createElement("planeGeometry",{args:[.3,.2]}),n.createElement("meshBasicMaterial",{color:a}))});J.displayName="CanvasTextScreen";var K=r(8955),Z=(0,n.createContext)(void 0),q="/NEXT_ThreeJs",ee=function(e){var t=e.children,r=(0,h.H)(d.E,"".concat(q,"/model/furniture/Carpet2.glb")),a=(0,h.H)(K.y,"".concat(q,"/model/furniture/TV.fbx")),o=(0,h.H)(d.E,"".concat(q,"/model/furniture/tv_cabinets.glb")),i=(0,h.H)(d.E,"".concat(q,"/model/furniture/glass_shelf.glb")),c=(0,h.H)(d.E,"".concat(q,"/model/furniture/stair2.glb")),l=(0,h.H)(d.E,"".concat(q,"/model/furniture/sofa.glb")),s=(0,h.H)(d.E,"".concat(q,"/model/furniture/wall_shelf.glb")),u=(0,h.H)(d.E,"".concat(q,"/model/TV_Game/nintendo_switch/scene.gltf")),m=(0,h.H)(d.E,"".concat(q,"/model/TV_Game/playstation_5_digital_edition/scene.gltf")),f=(0,h.H)(d.E,"".concat(q,"/model/TV_Game/controller.glb")),p=(0,h.H)(d.E,"".concat(q,"/model/TV_Game/xbox_one.glb")),y=(0,h.H)(d.E,"".concat(q,"/model/car/carModel/scene.gltf")),E=(0,h.H)(d.E,"".concat(q,"/model/collection/gundam_basic/scene.gltf")),v=(0,h.H)(d.E,"".concat(q,"/model/collection/monster/base_basic_shaded.glb")),g=(0,h.H)(K.y,"".concat(q,"/model/collection/kuba/kuba_Binary.fbx")),w=(0,h.H)(d.E,"".concat(q,"/model/collection/teemo/scene.gltf")),b=(0,h.H)(d.E,"".concat(q,"/model/collection/mask_shaded.glb")),S=(0,h.H)(d.E,"".concat(q,"/model/collection/littleMonster_shaded.glb")),M=(0,h.H)(d.E,"".concat(q,"/model/garbage/pepsi_cap/scene.gltf")),x=(0,h.H)(d.E,"".concat(q,"/model/garbage/trashCan/scene.gltf")),P=(0,h.H)(d.E,"".concat(q,"/model/garbage/colaGarbage2.glb")),I=(0,h.H)(d.E,"".concat(q,"/model/garbage/milk_carton/scene.gltf")),C=(0,h.H)(d.E,"".concat(q,"/model/garbage/plastic_bottle/scene.gltf")),R=(0,n.useMemo)(function(){return{carpet:r,TVElement:a,TVCabnit:o,GlassShelf:i,Stair:c,Sofa:l,WallShelf:s,NintendoSwitch:u,PS5:m,XboxController:f,Xbox:p,CarModel:y,GundamBasicModel:E,SatyrMonsterModel:v,KubaModel:g,TeemoModel:w,MaskModel:b,LittleMonsterModel:S,PepsiCap:M,TrashCan:x,ColaGarbage:P,MilkCrton:I,PlasticBottle:C}},[r,a,o,i,c,l,s,u,m,f,p,y,E,v,g,w,b,S,M,x,P,I,C]);return n.createElement(Z.Provider,{value:{models:R}},t)},et=["argss","color","pointLight","intensity","distance","decay"],er=function(e){var t=e.argss,r=e.color,a=void 0===r?"cyan":r,o=e.pointLight,c=e.intensity,l=e.distance,s=e.decay,u=function(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}(e,et),m=(0,n.useContext)(p.l).shadowShow,d=(0,n.useRef)(null);return(0,n.useEffect)(function(){d.current&&(m?d.current.castShadow=!0:d.current.castShadow=!1)},[m]),n.createElement("group",u,n.createElement(i.Ab,{args:void 0===t?[.02,.02,3,32,1,!1,0,2*Math.PI]:t,position:[0,0,0]},n.createElement("meshPhysicalMaterial",{color:a,emissive:a,emissiveIntensity:1,transparent:!0,opacity:1})),void 0!==o&&o&&n.createElement("pointLight",{ref:d,color:a,intensity:void 0===c?5:c,distance:void 0===l?30:l,decay:void 0===s?.8:s,position:[0,0,0],"shadow-mapSize-width":256,"shadow-mapSize-height":256,"shadow-camera-far":5,"shadow-camera-near":.1,"shadow-radius":3,castShadow:!0}))},en=["color"],ea=["model"],eo=["model","visibleState"],ei=["model"],ec=["model"],el=["model"],es=["model"],eu=["model","scaleX"],em=["model"],ed=["model"],ef=["model"],eh=["model"],ep=["model","conditionalDisplay"],ey=["model","conditionalDisplay"],eE=["model","conditionalDisplay"],ev=["model","conditionalDisplay"],eg=["model","conditionalDisplay"],ew=["model","conditionalDisplay"],eb=["model","conditionalDisplay"],eS=["model"],eM=["models"],ex=["model"],eP=["model"],eI=["model"];function eC(){return(eC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function eR(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var ej="/NEXT_ThreeJs",eN=function(e){var t=e.color,r=eR(e,en);return n.createElement("group",null,n.createElement(c.ib,{type:"fixed",colliders:"cuboid"},n.createElement("mesh",eC({},r,{castShadow:!0,receiveShadow:!0}),n.createElement("planeGeometry",{args:[24,30]}),n.createElement("meshPhysicalMaterial",{color:t,transparent:!0,opacity:1}))))},eT=function(){var e=(0,n.useRef)(null);return(0,n.useEffect)(function(){new f.TextureLoader().load("".concat(ej,"/material/TCom_Fabric_DishCloth2_2K_albedo.jpg"),function(t){t.wrapS=f.RepeatWrapping,t.wrapT=f.RepeatWrapping,t.repeat.set(10,10),e.current&&(e.current.map=t,e.current.needsUpdate=!0,e.current.color.setScalar(.1))})},[]),n.createElement(c.ib,{type:"fixed",colliders:"cuboid",position:[0,0,0]},n.createElement("mesh",{"rotation-x":-Math.PI/2,position:[0,0,0],receiveShadow:!0},n.createElement("planeGeometry",{args:[24,24]}),n.createElement("meshStandardMaterial",{ref:e,transparent:!0,opacity:1})))},eD=function(e){var t=e.model,r=eR(e,ea),a=(0,n.useMemo)(function(){var e=t.scene.clone(!0);return e.traverse(function(e){e instanceof f.Mesh&&(e.castShadow=!0,e.receiveShadow=!0)}),e},[t]);return t?n.createElement("group",eC({},r,{castShadow:!0,receiveShadow:!0}),n.createElement(c.ib,{type:"fixed",colliders:"trimesh",position:[0,-10,0]},n.createElement("primitive",{object:a}),n.createElement("meshStandardMaterial",{metalness:0,roughness:1}))):(console.log(" No 'Carpet' model loading detected"),null)},ek=function(){return n.createElement(c.ib,{type:"fixed",position:[0,25,0]},n.createElement("mesh",{"rotation-x":-Math.PI/2,receiveShadow:!0,castShadow:!0},n.createElement("boxGeometry",{args:[24,24,1]}),n.createElement("meshStandardMaterial",{color:"rgb(21, 38, 66)"})))},eO=function(e){var t=e.model,r=e.visibleState,a=eR(e,eo),o=(0,n.useContext)(p.l),l=o.shadowShow,s=o.playClawMachineStateRef,u=(0,n.useRef)(null),m=(0,n.useRef)(null);(0,n.useEffect)(function(){t&&t.traverse(function(e){e.isMesh&&(e.castShadow=!0,e.receiveShadow=!0)})},[t]),(0,n.useEffect)(function(){u.current&&(u.current.visible=r)},[r]),(0,n.useEffect)(function(){var e=document.createElement("video");e.src="".concat(ej,"/model/furniture/3163534-uhd_3840_2160_30fps.mp4"),e.crossOrigin="Anonymous",e.loop=!0,e.muted=!0,e.onerror=function(){console.error("Video failed to load:",e.src)},e.oncanplay=function(){e.play().catch(function(e){console.error("Error attempting to play video:",e)})};var t=new f.VideoTexture(e);return t.minFilter=f.LinearFilter,t.magFilter=f.LinearFilter,t.format=f.RGBFormat,m.current&&(m.current.material=new f.MeshBasicMaterial({map:t,color:16777215})),function(){e.pause(),e.src="",e.load()}},[m]);var d=(0,n.useRef)(null);return((0,h.F)(function(){if(!s.current&&!d.current)return}),(0,n.useEffect)(function(){d.current&&(l?d.current.castShadow=!0:d.current.castShadow=!1)},[l]),t)?n.createElement("group",eC({ref:u},a,{castShadow:!0,receiveShadow:!0,scale:1.5}),n.createElement(c.ib,{type:"fixed",colliders:"hull",position:[-12.5,10,0],scale:.05},n.createElement("primitive",{object:t})),n.createElement(i.xu,{args:[5.3,3,.01],position:[.25,6.6,0],ref:m},n.createElement("meshStandardMaterial",{color:"blue"}),n.createElement("pointLight",{ref:d,color:"#ffffff",intensity:1.5,distance:15,decay:1,position:[0,0,0],"shadow-mapSize-width":64,"shadow-mapSize-height":64,"shadow-camera-far":10,"shadow-camera-near":.1,"shadow-radius":1,castShadow:!0}))):(console.log(" No 'TVElement' model loading detected"),null)},eG=function(e){var t=e.model,r=eR(e,ei);return((0,n.useEffect)(function(){t&&t.scene.traverse(function(e){e instanceof f.Mesh&&(e.castShadow=!0,e.receiveShadow=!0)})},[t]),t)?n.createElement("group",eC({},r,{castShadow:!0,receiveShadow:!0}),n.createElement(c.ib,{type:"fixed",colliders:"hull",scale:[3,2,2.5]},n.createElement("primitive",{object:t.scene,castShadow:!0,receiveShadow:!0}))):(console.log(" No 'TVCabnit' model loading detected"),null)},ez=function(e){var t=e.model,r=eR(e,ec);return((0,n.useEffect)(function(){t&&t.scene.traverse(function(e){e instanceof f.Mesh&&(e.castShadow=!0,e.material=new f.MeshStandardMaterial({color:"rgb(83, 83, 83)",metalness:0,roughness:1}),e.userData.climbable=!0,e.userData.name="stair",e.receiveShadow=!0)})},[t]),t)?n.createElement("group",eC({},r,{castShadow:!0,receiveShadow:!0}),n.createElement(c.ib,{type:"fixed",userData:{id:"stair"},colliders:"trimesh",scale:[3,2,1.3]},n.createElement("primitive",{object:t.scene}))):(console.log(" No 'Stair' model loading detected"),null)},eA=function(e){var t=e.model,r=eR(e,el),a=(0,n.useMemo)(function(){var e=t.scene.clone(!0);return e.traverse(function(e){e instanceof f.Mesh&&(e.castShadow=!0,e.receiveShadow=!0)}),e},[t]);return t?n.createElement("group",eC({},r,{castShadow:!0,receiveShadow:!0}),n.createElement(c.ib,{type:"fixed",colliders:"hull",scale:[3,2,1]},n.createElement("primitive",{object:a}))):(console.log(" No 'Sofa' model loading detected"),null)},eB=(0,n.memo)(function(e){var t=e.model,r=eR(e,es),a=(0,n.useMemo)(function(){if(t){var e=t.scene.clone(!0);return e.traverse(function(e){if(e instanceof f.Mesh){e.castShadow=!0,e.receiveShadow=!0;var t=e.material;e.material=new f.MeshStandardMaterial({color:"rgb(0, 0, 0)",metalness:.1,roughness:.5,transparent:t.transparent,opacity:t.opacity,envMapIntensity:t.envMapIntensity||1.8,blending:t.blending,side:t.side})}}),e}},[t]);return t?n.createElement("group",eC({},r,{castShadow:!0,receiveShadow:!0}),n.createElement(c.ib,{type:"fixed",colliders:"trimesh",mass:.02,restitution:.1,friction:1,linearDamping:4,angularDamping:4,gravityScale:1},n.createElement("primitive",{object:a}))):(console.log(" No 'GlassShelf' model loading detected"),null)});eB.displayName="GlassShelf";var eF=function(e){var t=e.model,r=e.scaleX,a=void 0===r?1:r,o=eR(e,eu),i=(0,n.useMemo)(function(){if(t){var e=t.scene.clone(!0);return e.traverse(function(e){e instanceof f.Mesh&&(e.castShadow=!0,e.material.metalness=1,e.material.roughness=.8)}),e.scale.x=a,e}},[t,a]);return t?n.createElement("group",o,n.createElement(c.ib,{type:"fixed",colliders:"trimesh",mass:.02,restitution:.1,friction:1,linearDamping:4,angularDamping:4,gravityScale:1},n.createElement("primitive",{object:i}))):(console.log(" No 'WallShelf' model loading detected"),null)},e_=function(e){var t=e.model,r=eR(e,em),a=(0,n.useMemo)(function(){if(t){var e=t.scene.clone(!0);return e.traverse(function(e){e.castShadow=!0}),e}},[t]);return t?n.createElement("group",r,n.createElement(c.ib,{type:"dynamic",colliders:"hull",mass:.6,restitution:.1,friction:1,gravityScale:1,linearDamping:5,angularDamping:5},n.createElement("primitive",{object:a}))):(console.log(" No 'NintendoSwitch' model loading detected"),null)},eL=function(e){var t=e.model,r=eR(e,ed),a=(0,n.useMemo)(function(){if(t){var e=t.scene.clone(!0);return e.traverse(function(e){e instanceof f.Mesh&&(e.castShadow=!0)}),e}},[t]);return t?n.createElement("group",r,n.createElement(c.ib,{type:"dynamic",colliders:"hull",mass:3,restitution:.1,friction:1,gravityScale:1,linearDamping:5,angularDamping:5},n.createElement("primitive",{object:a,roughnes:.1,metalness:.8}))):(console.log(" No 'PS5' model loading detected"),null)},eH=function(e){var t=e.model,r=eR(e,ef),a=(0,n.useMemo)(function(){if(t){var e=t.scene.clone(!0);return e.traverse(function(e){e instanceof f.Mesh&&(e.castShadow=!0,e.material.metalness=.6,e.material.roughness=.7)}),e}},[t]);return t?n.createElement("group",r,n.createElement(c.ib,{type:"dynamic",colliders:"hull",mass:3,restitution:.1,friction:1,gravityScale:1,linearDamping:5,angularDamping:5,ccd:!0},n.createElement("primitive",{object:a}))):(console.log(" No 'Xbox Controller' model loading detected"),null)},eV=function(e){var t=e.model,r=eR(e,eh),a=(0,n.useMemo)(function(){if(t){var e=t.scene.clone(!0);return e.traverse(function(e){e instanceof f.Mesh&&(e.castShadow=!0,e.receiveShadow=!0,e.material.metalness=.6,e.material.roughness=.3)}),e}},[t]);return t?n.createElement("group",r,n.createElement(c.ib,{type:"dynamic",colliders:"cuboid",mass:3,restitution:.1,friction:1,gravityScale:1,linearDamping:5,angularDamping:5},n.createElement("primitive",{object:a}))):(console.log(" No 'Xbox' model loading detected"),null)},eX=function(e){var t=e.model,r=e.conditionalDisplay,a=eR(e,ep),o=(0,n.useMemo)(function(){if(t){var e=t.scene.clone(!0);return e.traverse(function(e){e instanceof f.Mesh&&(e.castShadow=!0,e.receiveShadow=!0,e.material.metalness=.7,e.material.roughness=.1)}),e}},[t]),c=(0,n.useRef)(null);return((0,n.useEffect)(function(){null!=r&&"boolean"==typeof r&&(r?c.current.visible=!0:c.current.visible=!1)},[r]),t)?n.createElement(n.Fragment,null,n.createElement("group",{ref:c},n.createElement("group",eC({},a,{castShadow:!0,receiveShadow:!0}),n.createElement("primitive",{object:o})),n.createElement("group",{position:a.position},n.createElement(i.Ab,{args:[.01,.01,.7,32],position:[-.4,-.25,.2],castShadow:!0,receiveShadow:!0},n.createElement("meshPhysicalMaterial",{color:"cyan",opacity:.2,transparent:!0,metalness:.8,roughness:.1,reflectivity:.9,clearcoat:1,clearcoatRoughness:0}))))):(console.log(" No 'Car' model loading detected"),null)},eQ=function(e){var t=e.model,r=e.conditionalDisplay,a=eR(e,ey),o=(0,m.v)(t.animations,t.scene).actions,l=(0,n.useMemo)(function(){if(t){var e=t.scene;return e.traverse(function(e){e instanceof f.Mesh&&(e.castShadow=!0,e.receiveShadow=!0,e.material.metalness=.9,e.material.roughness=.3)}),e}},[t]),s=(0,n.useRef)(null);(0,n.useEffect)(function(){s.current=o["02-IDLE"],s.current&&s.current.play();var e=setTimeout(function(){s.current&&(s.current.time=0,s.current.paused=!0)},0);return function(){return clearTimeout(e)}},[o]);var u=(0,n.useRef)(null);return((0,n.useEffect)(function(){r?u.current.visible=!0:u.current.visible=!1},[r]),t)?n.createElement("group",eC({},a,{ref:u}),n.createElement(c.ib,{type:"fixed",colliders:"hull",position:[0,0,-.7],rotation:[Math.PI/6,0,0]},n.createElement("primitive",{object:l})),n.createElement(i.Ab,{args:[.01,.01,1.5,32],position:[0,.4,-.4],castShadow:!0,receiveShadow:!0},n.createElement("meshPhysicalMaterial",{color:"cyan",opacity:.2,transparent:!0,metalness:.8,roughness:.1,reflectivity:.9,clearcoat:1,clearcoatRoughness:0}))):(console.log(" No 'Gundam' model loading detected"),null)},eU=function(e){var t=e.model,r=e.conditionalDisplay,a=eR(e,eE),o=(0,n.useMemo)(function(){if(t){var e=t.scene.clone(!0);return e.traverse(function(e){e instanceof f.Mesh&&(e.castShadow=!0,e.receiveShadow=!0)}),e}},[t]),i=(0,n.useRef)(null);return((0,n.useEffect)(function(){r?i.current.visible=!0:i.current.visible=!1},[r]),t)?n.createElement("group",eC({},a,{ref:i}),n.createElement(c.ib,{type:"fixed",colliders:"hull"},n.createElement("primitive",{object:o}))):(console.log(" No 'SatyrMonsterModel' model loading detected"),null)},eW=function(e){var t=e.model,r=e.conditionalDisplay,a=eR(e,ev),o=(0,m.v)(t.animations,t).actions,i=(0,h.H)(f.TextureLoader,"".concat(ej,"/model/collection/kuba/textures/basecolor.png")),l=(0,n.useMemo)(function(){return{map:i}},[i]),s=(0,n.useMemo)(function(){if(t)return t.traverse(function(e){e instanceof f.Mesh&&(e.material=new f.MeshStandardMaterial({map:l.map}),e.castShadow=!0,e.geometry.computeVertexNormals(),e.material.needsUpdate=!0)}),t},[t,l]);(0,n.useEffect)(function(){var e=o["mixamo.com"];e&&(e.time=3,e.paused=!0,e.play())},[o]);var u=(0,n.useRef)(null);return((0,n.useEffect)(function(){r?u.current.visible=!0:u.current.visible=!1},[r]),t)?n.createElement("group",eC({},a,{ref:u}),n.createElement(c.ib,{type:"fixed",colliders:"hull"},n.createElement("primitive",{object:s}))):(console.log(" No 'KubaModel' model loading detected"),null)},eY=function(e){var t=e.model,r=e.conditionalDisplay,a=eR(e,eg),o=(0,n.useMemo)(function(){if(t){var e=t.scene;return e.traverse(function(e){e instanceof f.Mesh&&(e.castShadow=!0,e.receiveShadow=!0,e.material.metalness=.1,e.material.roughness=.4)}),e}},[t]),i=(0,n.useRef)(null);return((0,n.useEffect)(function(){r?i.current.visible=!0:i.current.visible=!1},[r]),t)?n.createElement("group",eC({},a,{ref:i}),n.createElement(c.ib,{type:"fixed",colliders:"hull"},n.createElement("primitive",{object:o}))):(console.log(" No 'Teemo' model loading detected"),null)},e$=function(e){var t=e.model,r=e.conditionalDisplay,a=eR(e,ew),o=(0,n.useMemo)(function(){if(t){var e=t.scene.clone(!0);return e.traverse(function(e){e instanceof f.Mesh&&(e.castShadow=!0,e.receiveShadow=!0)}),e}},[t]),i=(0,n.useRef)(null);return((0,n.useEffect)(function(){r?i.current.visible=!0:i.current.visible=!1},[r]),t)?n.createElement("group",eC({},a,{ref:i}),n.createElement(c.ib,{type:"fixed",colliders:"hull"},n.createElement("primitive",{object:o}))):(console.log(" No 'Mask' model loading detected"),null)},eJ=function(e){var t=e.model,r=e.conditionalDisplay,a=eR(e,eb),o=(0,n.useMemo)(function(){if(t){var e=t.scene.clone(!0);return e.traverse(function(e){e instanceof f.Mesh&&(e.castShadow=!0,e.receiveShadow=!0)}),e}},[t]),i=(0,n.useRef)(null);return((0,n.useEffect)(function(){r?i.current.visible=!0:i.current.visible=!1},[r]),t)?n.createElement("group",eC({},a,{ref:i}),n.createElement(c.ib,{type:"fixed",colliders:"hull"},n.createElement("primitive",{object:o}))):(console.log(" No 'LittleMonster' model loading detected"),null)},eK=function(e){var t=e.model,r=eR(e,eS);return t?n.createElement("group",eC({},r,{castShadow:!0,receiveShadow:!0}),n.createElement(c.ib,{type:"dynamic",colliders:"cuboid",mass:.001,restitution:.1,friction:1,gravityScale:1,linearDamping:5,angularDamping:5},n.createElement("primitive",{object:t.scene.clone()}))):(console.log(" No 'PepsiCap' model loading detected"),null)},eZ=function(e){var t=e.models,r=eR(e,eM),a=t.TrashCan,o=(0,n.useMemo)(function(){if(a){var e=a.scene.clone(!0);return e.traverse(function(e){e instanceof f.Mesh&&(e.castShadow=!0)}),e}},[a]);return t&&t.TrashCan?n.createElement("group",r,n.createElement(c.ib,{type:"dynamic",position:[0,-.01,0],colliders:"trimesh",mass:20,restitution:.1,friction:1,linearDamping:5,angularDamping:5},n.createElement("primitive",{object:o})),n.createElement(eq,{model:t.ColaGarbage,position:[0,.3,0],scale:1.5}),n.createElement(eK,{model:t.PepsiCap,position:[0,.3,0],scale:.02}),n.createElement(eK,{model:t.PepsiCap,position:[.01,.4,0],scale:.02}),n.createElement(e0,{model:t.MilkCrton,position:[.02,.8,0]}),n.createElement(e1,{model:t.PlasticBottle,position:[-.01,1,0],scale:5})):(console.log(" No 'TrashCan' model loading detected"),null)},eq=function(e){var t=e.model,r=eR(e,ex),a=(0,n.useMemo)(function(){if(t){var e=t.scene.clone(!0);return e.traverse(function(e){e instanceof f.Mesh&&(e.castShadow=!0,e.receiveShadow=!0)}),e}},[t]);return t?n.createElement("group",r,n.createElement(c.ib,{type:"dynamic",colliders:"hull",mass:.02,restitution:.1,friction:1,linearDamping:4,angularDamping:4,gravityScale:1},n.createElement("primitive",{object:a}))):(console.log(" No 'ColaGarbage' model loading detected"),null)},e0=function(e){var t=e.model,r=eR(e,eP);return((0,n.useEffect)(function(){t&&t.scene.traverse(function(e){e instanceof f.Mesh&&(e.castShadow=!0,e.receiveShadow=!0)})},[t]),t)?n.createElement("group",eC({},r,{castShadow:!0,receiveShadow:!0,scale:.001}),n.createElement(c.ib,{type:"dynamic",colliders:"hull",mass:.015,restitution:.1,friction:1,linearDamping:5,angularDamping:5,gravityScale:1},n.createElement("primitive",{object:t.scene.clone()}))):(console.log(" No 'MilkCrton' model loading detected"),null)},e1=function(e){var t=e.model,r=eR(e,eI);return((0,n.useEffect)(function(){t&&t.scene.traverse(function(e){e.isMesh&&(e.castShadow=!0,e.receiveShadow=!0)})},[t]),t)?n.createElement("group",eC({},r,{castShadow:!0,receiveShadow:!0}),n.createElement(c.ib,{type:"dynamic",colliders:"hull",mass:.01,restitution:.1,friction:1,linearDamping:5,angularDamping:5,gravityScale:1},n.createElement("primitive",{object:t.scene.clone()}))):(console.log(" No 'PlasticBottle' model loading detected"),null)},e2=(0,n.memo)(function(e){var t=e.positions,r=e.color,a=void 0===r?"white":r,o=e.intensity,i=void 0===o?2:o,c=e.distance,l=void 0===c?2:c,s=e.decay,u=void 0===s?.5:s,m=e.visibleState,d=void 0===m||m,y=(0,n.useContext)(p.l).playClawMachineStateRef,E=(0,n.useRef)(null),v=(0,n.useRef)([]),g=(0,n.useMemo)(function(){return new f.MeshPhysicalMaterial({color:a,emissive:a,emissiveIntensity:1.5,transparent:!0,opacity:0})},[a]);return(0,n.useEffect)(function(){E.current&&(t.forEach(function(e,t){var r=new f.Matrix4;r.setPosition(e[0],e[1],e[2]),E.current.setMatrixAt(t,r)}),E.current.instanceMatrix.needsUpdate=!0)},[t]),(0,n.useEffect)(function(){v.current.forEach(function(e){e&&(e.visible=d)})},[d]),(0,h.F)(function(e){var r=e.clock;if(!y.current){var n=r.getElapsedTime();t.forEach(function(e,t){var r=i+.1*Math.sin(n+t)+.05*Math.random(),a=E.current.getObjectByName("pointLight-".concat(t));a&&(a.intensity=r)})}}),n.createElement("group",null,n.createElement("instancedMesh",{ref:E,args:[new f.CylinderGeometry(.01,.01,.1,32),g,t.length]}),t.map(function(e,t){return n.createElement("pointLight",{key:t,ref:function(e){v.current[t]=e},name:"pointLight-".concat(t),color:a,intensity:i,distance:l,decay:u,position:e,castShadow:!0,"shadow-mapSize-width":512,"shadow-mapSize-height":512,"shadow-camera-near":.5,"shadow-camera-far":50})}))});e2.displayName="MicroPointLight";var e5=function(e){var t=e.lightOn,r=(0,n.useContext)(Z).models,a=(0,n.useContext)(p.l).controlObjectRef,o=(0,n.useRef)(null);return n.createElement(n.Fragment,null,n.createElement("group",{position:[0,0,0]},n.createElement(eN,{position:[0,15,12],rotation:[0,Math.PI,0],color:"rgb(21, 38, 66)"}),n.createElement(eN,{position:[0,15,-12],color:"rgb(21, 38, 66)"}),n.createElement(eN,{position:[12,15,0],rotation:[0,-Math.PI/2,0],color:"rgb(21, 38, 66)"}),n.createElement(eN,{position:[-12,15,0],rotation:[0,Math.PI/2,0],color:"rgb(21, 38, 66)"}),n.createElement(eT,null),n.createElement("pointLight",{color:"white",intensity:t?10:2,distance:30,decay:.5,position:[0,15,0],"shadow-mapSize-width":512,"shadow-mapSize-height":512,"shadow-camera-far":20,"shadow-camera-near":.5,"shadow-radius":3,castShadow:!0}),n.createElement(eD,{model:r.carpet,position:[2,.02,0],scale:[.1,.1,.2],rotation:[0,Math.PI/2,0]}),n.createElement(ek,null),n.createElement(eO,{model:r.TVElement,visibleState:"character"===a.current,position:[11.65,-3.5,-.375],rotation:[0,-Math.PI/2,0]}),n.createElement(eG,{model:r.TVCabnit,position:[11,0,0],rotation:[0,-Math.PI/2,0]}),n.createElement(er,{color:"cyan",argss:[.02,.02,6.5,32,1,!1,0,2*Math.PI],position:[10.2,1.12,-1.2],rotation:[Math.PI/2,0,0]}),n.createElement(er,{color:"cyan",argss:[.02,.02,9,32,1,!1,0,2*Math.PI],position:[10.2,.25,0],rotation:[Math.PI/2,0,0]}),n.createElement(eB,{model:r.GlassShelf,position:[12,7,8],scale:[3,5,5],rotation:[0,Math.PI/2,0]}),n.createElement(er,{color:"cyan",pointLight:!0,position:[11,7.3,8],rotation:[Math.PI/2,0,0],distance:4}),n.createElement(eB,{model:r.GlassShelf,position:[12,7,-8],scale:[3,5,5],rotation:[0,Math.PI/2,0]}),n.createElement(er,{color:"cyan",pointLight:!0,position:[11,7.3,-8],rotation:[Math.PI/2,0,0],distance:4}),n.createElement(ez,{model:r.Stair,position:[-12,0,12],rotation:[0,Math.PI/2,0],scale:[1.2,1.7,2]}),n.createElement(eA,{model:r.Sofa,position:[-5.3,0,0],rotation:[0,Math.PI/2.2,0],scale:[.7,1,3]}),n.createElement(eF,{model:r.WallShelf,position:[4,5,12],scale:[7,7,9],rotation:[0,Math.PI,0]}),n.createElement(e2,{positions:[[3.75,7.5,10.7],[3.75,5.9,11],[2,6.9,11],[.8,7.6,11],[-.8,6.5,10.8]],color:"white",visibleState:"character"===a.current,intensity:2,distance:2,decay:.5}),n.createElement(e_,{model:r.NintendoSwitch,position:[10.6,2.3,0],scale:.3,rotation:[-Math.PI/2.3,0,-Math.PI/2.3]}),n.createElement(eL,{model:r.PS5,position:[11.3,2.1,-2.5],scale:.004}),n.createElement(eH,{model:r.XboxController,position:[7.7,1,4],scale:.8,rotation:[0,Math.PI/1.3,0]}),n.createElement(eH,{model:r.XboxController,position:[9.5,1.5,3],scale:.8,rotation:[0,Math.PI,Math.PI/2]}),n.createElement(eV,{model:r.Xbox,position:[10,1,3],scale:4,rotation:[0,-Math.PI/2.1,Math.PI]}),n.createElement(eX,{model:r.CarModel,conditionalDisplay:"character"===a.current,position:[11.8,7.9,-8],scale:.05,rotation:[-Math.PI/90,Math.PI/1.1,-Math.PI/10]}),n.createElement(eQ,{model:r.GundamBasicModel,conditionalDisplay:"character"===a.current,position:[11.1,7.6,8],scale:.75,rotation:[0,-Math.PI/2,0]}),n.createElement(eU,{model:r.SatyrMonsterModel,conditionalDisplay:"character"===a.current,position:[3.7,5.8,11.4],scale:.75,rotation:[0,Math.PI,0]}),n.createElement(eW,{model:r.KubaModel,conditionalDisplay:"character"===a.current,position:[4.4,6.8,12.6],scale:.35,rotation:[0,Math.PI/.85,0]}),n.createElement(eY,{model:r.TeemoModel,conditionalDisplay:"character"===a.current,position:[-.8,5.9,11.4],scale:.015,rotation:[0,Math.PI,0]}),n.createElement(e$,{model:r.MaskModel,conditionalDisplay:"character"===a.current,position:[2.2,6.7,11.4],scale:.75,rotation:[0,Math.PI,0]}),n.createElement(eJ,{model:r.LittleMonsterModel,conditionalDisplay:"character"===a.current,position:[.7,7.3,11.4],scale:.5,rotation:[0,Math.PI,0]}),n.createElement(eK,{model:r.PepsiCap,position:[6,.5,9],scale:.1,rotation:[-Math.PI/2,0,0]}),n.createElement(eZ,{models:r,position:[-7,.3,-10],scale:3}),n.createElement(eq,{model:r.ColaGarbage,position:[-7.5,.2,-10.5],scale:4}),n.createElement(eq,{model:r.ColaGarbage,position:[-7.5,.4,-2],scale:4}),n.createElement(S,null,n.createElement(F,{bodyPosition:[0,0,-10.9],ref:o}))))},e3=function(){return(0,n.useEffect)(function(){var e=console.warn;return console.warn=function(){var t;null!==(t=arguments.length<=0?void 0:arguments[0])&&void 0!==t&&t.includes("THREE.FBXLoader: Vertex has more than 4 skinning weights assigned to vertex")||e.apply(void 0,arguments)},function(){console.warn=e}},[]),null},e6=r(2315);function e7(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,o,i,c=[],l=!0,s=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(c.push(n.value),c.length!==t);l=!0);}catch(e){s=!0,a=e}finally{try{if(!l&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw a}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return e4(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return e4(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function e4(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function e8(){var e=e7((0,n.useState)(!1),2),t=e[0],r=e[1],m=e7((0,n.useState)(0),2),d=m[0];m[1];var f=(0,o.S)().loaded;(0,n.useEffect)(function(){r(!0)},[f]);var h=(0,n.useContext)(p.l),y=h.shadowShow,v=h.setShadowShow,g=h.controlObjectRef,w=e7((0,n.useState)(!1),2),b=w[0],S=w[1],M=e7((0,n.useState)(!1),2),x=M[0],P=M[1];return(0,u.y1)("g",function(){S(function(e){return!e})}),(0,u.y1)("m",function(){S(function(e){return!e})}),(0,u.y1)("o",function(){P(function(e){return!e})}),(0,u.y1)("p",function(){v(!y)}),n.createElement(n.Fragment,null,n.createElement(e3,null),n.createElement("div",{className:"bg-red w-full"},n.createElement(e9,{loadingComplete:t,loadingDegree:d}),n.createElement(a.Xz,{className:"bg-black",shadows:y},n.createElement(l.x,null,n.createElement(s.d,{intensity:.5,luminanceThreshold:.2,luminanceSmoothing:.9,radius:1})),n.createElement(i.aL,{args:[1,32,32],position:[-12,10,-10]},n.createElement("meshStandardMaterial",{attach:"material",color:"royalblue"})),n.createElement(n.Suspense,{fallback:null},n.createElement(c.wI,{debug:!!b,timeStep:1/60},n.createElement(ee,null,n.createElement(e5,{lightOn:x})),n.createElement(E,{iniPosition:[8,.07,-8]})))),t&&"character"===g.current&&n.createElement("div",{className:"absolute bottom-4 right-4"},n.createElement("div",{className:"text-slate-50 flex items-center space-x-1"},n.createElement("span",{className:"w-6 h-6 rounded-md bg-stone-600/50 flex items-center justify-center backdrop-blur-sm"},n.createElement(e6.default,{src:"icon/mouse.svg",alt:"Mouse",className:"w-5 h-5",width:20,height:20})),n.createElement("span",{className:"p-2"},"視角切換")),n.createElement("div",{className:"text-slate-50 flex items-center space-x-1"},n.createElement("span",{className:"w-6 h-6 rounded-md bg-stone-600/50 flex items-center justify-center backdrop-blur-sm"},"O"),n.createElement("span",{className:"p-2"},x?"關燈":"開燈")),n.createElement("div",{className:"text-slate-50 flex items-center space-x-1"},n.createElement("span",{className:"w-6 h-6 rounded-md bg-stone-600/50 flex items-center justify-center backdrop-blur-sm"},"P"),n.createElement("span",{className:"p-2"},y?"陰影關閉":"陰影啟用")),n.createElement("div",{className:"text-slate-50 flex items-center space-x-1"},n.createElement("span",{className:"w-6 h-6 rounded-md bg-stone-600/50 flex items-center justify-center backdrop-blur-sm"},"W"),n.createElement("span",{className:"w-6 h-6 rounded-md bg-stone-600/50 flex items-center justify-center backdrop-blur-sm"},"A"),n.createElement("span",{className:"w-6 h-6 rounded-md bg-stone-600/50 flex items-center justify-center backdrop-blur-sm"},"S"),n.createElement("span",{className:"w-6 h-6 rounded-md bg-stone-600/50 flex items-center justify-center backdrop-blur-sm"},"D"),n.createElement("span",{className:"p-2"},"人物移動")))))}var e9=function(e){var t=e.loadingComplete,r=e.loadingDegree;return n.createElement(n.Fragment,null,n.createElement("div",{className:"absolute w-full h-[calc(100%-4rem)] z-50  bg-neutral-950 text-slate-50 text-base transition-opacity duration-2000 ".concat(t?"opacity-0 pointer-events-none":"opacity-100")},n.createElement("div",{className:"absolute left-1/2 top-1/2 transform -translate-x-1/2 -translate-y-1/2"},n.createElement("p",{className:"text-center"},"讀取中"),n.createElement("progress",{className:"w-64 h-1 rounded-lg appearance-none bg-gray-200 \r [&::-webkit-progress-bar]:rounded-lg \r [&::-webkit-progress-value]:rounded-lg \r [&::-webkit-progress-value]:bg-cyan-200\r [&::-webkit-progress-value]:shadow-[0_0_10px_3px_rgba(0,255,255,0.7)] \r [&::-webkit-progress-value]:transition-all",value:r,max:1}))))}},6190:function(e,t,r){"use strict";r.d(t,{l:function(){return i},t:function(){return c}});var n=r(2265);function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,o,i,c=[],l=!0,s=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(c.push(n.value),c.length!==t);l=!0);}catch(e){s=!0,a=e}finally{try{if(!l&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw a}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return o(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var i=(0,n.createContext)(void 0),c=function(e){var t=e.children,r=a((0,n.useState)(!0),2),o=r[0],c=r[1],l=(0,n.useRef)(!1),s=(0,n.useRef)("character"),u=(0,n.useRef)(!1),m=a((0,n.useState)(!1),2),d=m[0],f=m[1];return n.createElement(i.Provider,{value:{shadowShow:o,setShadowShow:c,mouseViewRef:l,controlObjectRef:s,playClawMachineStateRef:u,playClawMachineState:d,setPlayClawMachineState:f}},t)}}},function(e){e.O(0,[689,732,537,203,971,165,744],function(){return e(e.s=5010)}),_N_E=e.O()}]);